/* =========================
   OpenLearn • Clean Styles
   ========================= */

/* === THEME TOKENS === */
:root {
  --bg: #0b0f17;
  --fg: #eaf1ff;
  --card: #111827;
  --muted: #9fb0c3;
  --border: #1f2a3b;
  --btnBg: #0f172a;
  --btnFg: #eaf1ff;
  --btnPrimaryBg: #2563eb;
  --btnPrimaryFg: #fff;
  --fontSize: 16px;
  --radius: 14px;

  --topbar-offset: 64px;
  --topbar-h: 56px;

  --sidebar-w: 72px;        /* collapsed (icons only) */
  --sidebar-w-exp: 220px;   /* expanded (icons + labels) */
  --content-max: 1200px;    /* max width of inner content */
  --gutter: 16px;           /* page side padding */

  /* Pills */
  --pill-ann: #1f2a44;
  --pill-ann-txt: #d6dcff;
  scrollbar-gutter: stable both-edges;

  --shadow-soft: 0 8px 24px rgba(0,0,0,0.16);
  --shadow-medium: 0 12px 36px rgba(0,0,0,0.22);
  --shadow-strong: 0 18px 50px rgba(0,0,0,0.28);
}

/* Reset / base */
*{ box-sizing:border-box; }
html{ font-size:var(--fontSize); height:100%; }
body{
  margin:0; height:100%;
  background:var(--bg); color:var(--fg);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif;
  -webkit-overflow-scrolling: touch;
  overflow-x: hidden;
}

/* Helpers */
.hidden, .ol-hidden{ display:none !important; }
.muted{ color:var(--muted); }
.row{ display:flex; align-items:center; gap:.6rem; }
.stack{ display:flex; flex-direction:column; gap:.6rem; }
.grow{ flex:1; }
.h4{ font-size:1.1rem; margin:0; }
a{ color:var(--btnPrimaryBg); text-decoration:none; }
a:hover{ opacity:.9; text-decoration:underline; }

/* ===== TOPBAR ===== */
#topbar{
  position:fixed; top:0; left:0; right:0; z-index:1200;
  background:var(--card); color:var(--fg);
  border-bottom:1px solid var(--border);
  padding-top: env(safe-area-inset-top);
  backdrop-filter: saturate(120%) blur(6px);
}
.topbar-row{
  display:grid; grid-template-columns:auto auto 1fr auto auto;
  gap:12px; align-items:center;
  height:var(--topbar-h);
  max-width:1200px; margin:0 auto; padding:0 14px;
}
.logo{ display:flex; align-items:center; font-weight:700; font-size:18px; }
.logo::before{
  content:""; width:32px; height:32px; margin-right:8px;
  background:url("./icons/plant.png") center/contain no-repeat;
}
#btn-burger{
  display:none; width:44px; height:40px; place-items:center;
  border:1px solid var(--border); border-radius:10px;
  background:transparent; color:var(--fg);
}

/* Search */
#topSearchWrap{ display:flex; align-items:center; justify-content:center; }
#topSearch{
  display:block;
  width:min(560px,62vw); height:40px; border-radius:10px;
  border:1px solid var(--border); background:var(--card); color:var(--fg);
  padding:0 12px;
}
.search-ico{ display:none; width:44px; height:40px; place-items:center;
  border:1px solid var(--border); border-radius:10px; background:var(--card); color:var(--fg); }

/* Pills + auth */
.top-right{ display:flex; align-items:center; gap:8px; }
.icon-pill{
  display:inline-flex; align-items:center; gap:8px; height:40px; padding:0 12px;
  border:1px solid var(--border); border-radius:999px; font-size:14px; cursor:pointer;
  transition: transform .08s ease, background .2s ease, border-color .2s ease;
}
.icon-pill:hover{ transform: translateY(-1px); }
.pill-ann{ background:rgba(255,255,255,.06); color:var(--fg); border-color:var(--border); }

/* ===== SIDEBAR ===== */
#sidebar{
  position:fixed; left:0; bottom:0; top:var(--topbar-offset); z-index:1100;
  width:var(--sidebar-w);
  background:var(--card); color:var(--fg);
  border-right:1px solid var(--border);
  overflow:auto;
  transform: translateX(-100%);
  transition: transform .25s ease, width .2s ease, box-shadow .2s ease;
}
#sidebar.expanded{ width:var(--sidebar-w-exp); }
@media(hover:hover){
  #sidebar:not(.show):hover{ width:var(--sidebar-w-exp); }
}
#sidebar nav{ padding:10px 8px; display:flex; flex-direction:column; gap:8px; }
#sidebar .navbtn{
  display:flex; align-items:center; gap:10px; height:48px; width:100%;
  border:1px solid var(--border); background:var(--card); color:var(--fg);
  border-radius:12px; cursor:pointer; padding:0 12px; justify-content:left;
  transition: background .15s ease, border-color .15s ease;
}
#sidebar .navbtn.active{ background:rgba(255,255,255,.08); border-color:var(--btnPrimaryBg); }
#sidebar .navbtn:hover{ background:rgba(255,255,255,.08); }
#sidebar .navbtn i{ width:28px; height:28px; display:grid; place-items:center; font-size:22px; line-height:1; margin-left:2px; }
#sidebar:not(.show):not(:hover) .navbtn span{ display:none; opacity:0; }
#sidebar:hover .navbtn span, #sidebar.show .navbtn span{ display:inline-block !important; opacity:1 !important; }
#sidebar.show{ width:var(--sidebar-w-exp); transform:translateX(0); box-shadow:0 10px 30px rgba(0,0,0,.35); }

/* ===== MAIN ===== */
#main{
  box-sizing:border-box; width:100%; position:relative; min-height:100vh; background:var(--bg);
  padding-top: calc(var(--topbar-h) + 16px);
  transition: margin-left .2s ease, padding .2s ease;
  max-width:none; z-index:1;
}

/* desktop: sidebar always visible, content offset equals collapsed width; hover expands */
@media(min-width:1025px){
  #sidebar{ transform:none !important; width:var(--sidebar-w); box-shadow:none; }
  #main{ margin-left:var(--sidebar-w); }
  #sidebar:hover ~ #main{ margin-left:var(--sidebar-w-exp); }
}

/* Pages */
.page{
  display:none;
  position:relative; background:var(--bg);
  max-width: calc(var(--content-max) + var(--gutter)*2);
  margin:0 auto; padding:16px var(--gutter) 24px;
  min-height: calc(100vh - var(--topbar-h) - 68px);
}
.page.visible{ display:block; }

/* Grids 4-3-2-1 */
.grid{ display:grid; gap:12px; grid-template-columns: repeat(4, minmax(0,1fr)); }
@media(max-width:1200px){ .grid{ grid-template-columns: repeat(3, minmax(0,1fr)); } }
@media(max-width:900px){  .grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media(max-width:600px){  .grid{ grid-template-columns: 1fr; } }

/* Tables */
.ol-table{ width:100%; border-collapse:collapse; }
.ol-table th, .ol-table td{ border-bottom:1px solid var(--border); padding:10px 8px; text-align:left; }
.ol-table th{ color:var(--muted); font-weight:600; }

/* Cards */
.card{
  background:var(--card); color:var(--fg);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:14px;
  box-shadow: var(--shadow-soft);
  transition: box-shadow .2s ease, transform .2s ease;
}
.card:hover{ box-shadow: var(--shadow-medium); transform: translateY(-2px); }

/* Course cards: actions pinned bottom */
.card.course{ display:flex; flex-direction:column; }
.card.course .course-body{ flex:1; display:flex; flex-direction:column; }
.card.course .course-body .row{ margin-top:auto; }

/* Buttons / inputs */
.btn{ padding:.55rem .85rem; border:1px solid var(--border); border-radius:10px; background:var(--btnBg); color:var(--btnFg); cursor:pointer; }
.btn:hover{ filter:brightness(.97); }
.btn.primary{ background:var(--btnPrimaryBg); color:var(--btnPrimaryFg); border-color:transparent; }
.btn.small{ padding:.35rem .6rem; font-size:.9rem; }
.input, select, textarea{ padding:.55rem .75rem; border-radius:10px; border:1px solid var(--border); background:var(--card); color:var(--fg); }
.input::placeholder, textarea::placeholder{ color:var(--muted); }

/* Course cover */
.course-cover{ width:100%; height:140px; object-fit:cover; border-radius:10px; background:#0c1424; }
.course .course-body{ margin-top:8px; }

/* Reader progress */
.progress{ background:#0b1020; border-radius:999px; height:6px; overflow:hidden; }
.progress .bar{ height:6px; background:#22d3ee; }

/* Toast */
#toast{
  position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
  background:#0c1424; color:#eaf1ff; border:1px solid var(--border);
  border-radius:10px; padding:.6rem .9rem; opacity:0; pointer-events:none; transition:opacity .2s; z-index:2000;
}
#toast.show{ opacity:1; }

/* Gating */
body.anon [data-requires-auth]{ pointer-events:auto; opacity:.55; filter:grayscale(40%); }
body.logged [data-requires-auth]{ pointer-events:auto; opacity:1; filter:none; }
.gated{ pointer-events:none; opacity:.55; filter:grayscale(40%); }

/* Chat */
#chatBox{
  max-height:280px; overflow-y:auto; padding:8px;
  background:var(--card); border:1px solid var(--border); border-radius:8px; margin-bottom:8px;
}
#chatBox .msg{ padding:6px 8px; margin-bottom:6px; background:rgba(255,255,255,.05); border-radius:6px; }
#chatInput{ flex:1; }
#chatSend{ margin-left:6px; }

/* Search → icon below 1200px */
@media(max-width:1199px){
  #topSearch{ display:none; }
  .search-ico{ display:inline-grid; }
}

/* Tablet/mobile */
@media(max-width:1024px){
  #sidebar{ transform: translateX(-100%); width:var(--sidebar-w-exp); }
  #sidebar.show{ transform:translateX(0); }
  #main{ margin-left:0; }
  #btn-burger{ display:grid; }
}
@media(max-width:768px){
  .topbar-row{ grid-template-columns:auto 1fr auto auto; gap:8px; }
  .logo{ font-size:16px; }
  .grid{ grid-template-columns: 1fr !important; }
  .course-cover{ height:150px; }
}
@media(max-width:520px){
  .icon-pill .txt{ display:none; }
}
@media(max-width:480px){
  .filters-wrap{ grid-template-columns:1fr; }
}

/* Modals */
dialog.ol-modal{ border:none; padding:0; }
dialog.ol-modal::backdrop{ background:rgba(10,14,25,.64); }
.ol-modal.card, .auth-modern{
  background:var(--card); color:var(--fg);
  border:1px solid var(--border); border-radius:16px; padding:18px;
  box-shadow: var(--shadow-strong);
}
.modal-title{ font-weight:700; }

/* Forms in modals */
.authpane, .modal-body form, #courseForm, #postForm, #profileForm{ display:grid; gap:10px; }
.authpane label, #courseForm label, #postForm label, #profileForm label{
  display:flex; flex-direction:column; gap:6px; font-weight:600; line-height:1.2; margin:6px 0;
}
.authpane .input, #courseForm .input, #postForm .input, #profileForm .input, #courseForm select.input{
  width:100%; height:42px; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:var(--card); color:var(--fg);
}
#courseForm textarea.input, #postForm textarea.input, #profileForm textarea.input{
  min-height:120px; height:auto; padding:12px; resize:vertical;
}
.authpane .input:focus, #courseForm .input:focus, #postForm .input:focus, #profileForm .input:focus, .authpane select.input:focus{
  outline:none; border-color: color-mix(in oklab, var(--btnPrimaryBg) 60%, var(--border));
  box-shadow: 0 0 0 3px rgba(37,99,235,.25);
}

/* Badge */
.badge{
  display:inline-flex; align-items:center; justify-content:center;
  min-width:18px; height:18px; padding:0 5px; margin-left:6px;
  border-radius:999px; font-size:12px; background:#ef4444; color:#fff; line-height:1;
}