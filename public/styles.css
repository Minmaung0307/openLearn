:root{
  --bg:#0b0f17; --fg:#eaf1ff; --card:#111827; --muted:#9fb0c3; --border:#1f2a3b;
  --btnBg:#0f172a; --btnFg:#eaf1ff; --btnPrimaryBg:#2563eb; --btnPrimaryFg:#fff;
  --fontSize:16px; --radius:12px; --pad:12px; --topbar-offset:56px;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--fg);font:400 var(--fontSize)/1.5 ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;display:flex}

/* Sidebar */
#sidebar{width:64px;background:color-mix(in oklab,var(--card) 92%, black 8%);border-right:1px solid var(--border);padding:10px;position:sticky;top:0;height:100vh;overflow:auto}
.sidebar-expanded #sidebar{width:220px}
#sidebar .brand{font-weight:800;font-size:14px;margin-bottom:10px;opacity:.9}
#sidebar .navbtn{display:block;width:100%;text-align:left;padding:8px 10px;margin:6px 0;border:1px solid transparent;border-radius:10px;background:transparent;color:var(--fg);cursor:pointer}
#sidebar .navbtn.active{background:var(--card);border-color:var(--border)}
#sidebar .sidebar-foot{margin-top:12px;border-top:1px dashed var(--border);padding-top:10px}

/* Topbar */
#topbar{position:sticky;top:0;left:0;right:0;z-index:50;display:flex;gap:8px;align-items:center;padding:8px 12px;background:color-mix(in oklab,var(--bg) 86%, black 14%);border-bottom:1px solid var(--border)}
#btn-burger{display:none}
.grow{flex:1}

/* Main */
#main{flex:1;padding:16px}
.page{display:none}
.page.visible{display:block}

/* Layout utils */
.grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
.grid.two{grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
.grid.three{grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
.stack{display:flex;flex-direction:column;gap:8px}
.row{display:flex;align-items:center;gap:8px}
.wrap{flex-wrap:wrap}

/* Cards/inputs/buttons */
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:var(--pad)}
.small{font-size:.9em}.muted{color:var(--muted)}
.btn{background:var(--btnBg);color:var(--btnFg);border:1px solid var(--border);padding:8px 12px;border-radius:10px;cursor:pointer}
.btn.primary{background:var(--btnPrimaryBg);color:var(--btnPrimaryFg);border-color:transparent}
.btn.small{padding:6px 10px;font-size:.9em}
.btn[disabled]{opacity:.6;cursor:not-allowed}
.input{width:100%;background:color-mix(in oklab,var(--card) 92%, white 8%);color:var(--fg);border:1px solid var(--border);border-radius:10px;padding:8px 10px}
textarea.input{min-height:90px;resize:vertical}

/* Course card */
.course-cover{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:10px}

/* Reader */
.progress{height:8px;background:color-mix(in oklab,var(--bg) 80%, white 20%);border-radius:999px;overflow:hidden}
#rdProgress{height:100%;width:0%;background:var(--btnPrimaryBg)}
.reader-page{padding:8px 0}

/* Table */
.ol-table{width:100%;border-collapse:collapse}
.ol-table th,.ol-table td{border-bottom:1px solid var(--border);padding:8px;text-align:left}
.ol-table thead th{color:var(--muted);font-weight:600}

/* Chat */
.chatlist{max-height:240px;overflow:auto;background:color-mix(in oklab,var(--card) 90%, white 10%);border:1px solid var(--border);border-radius:10px;padding:8px;margin-top:6px}
.chatlist .msg{margin:6px 0}.chatlist .msg b{margin-right:6px}

/* Modal */
.ol-modal{border:none;padding:0;background:transparent}
.ol-modal::backdrop{background:rgba(0,0,0,.5)}
.h4{font-size:1.15rem;font-weight:800}

/* Toast */
#toast{position:fixed;left:50%;transform:translateX(-50%) translateY(20px);bottom:10px;background:var(--card);color:var(--fg);padding:8px 12px;border:1px solid var(--border);border-radius:10px;opacity:0;transition:.2s;pointer-events:none;z-index:1000}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* Drawer for iPad/touch */
#sidebar.show{transform:translateX(0)}
@media (max-width:1024px), (hover:none), (pointer:coarse){
  body{overflow-x:hidden}
  #sidebar{position:fixed;left:0;top:0;bottom:0;z-index:60;transform:translateX(-110%);transition:transform .2s ease}
  #sidebar.show{transform:translateX(0)}
  .sidebar-expanded #sidebar{width:220px}
  #btn-burger{display:inline-flex}
  #main{padding:14px}
}

/* Utility */
.hidden{display:none !important}