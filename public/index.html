<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>OpenLearn Lite</title>

<!-- config FIRST -->
<script src="/config.js"></script>

<link rel="manifest" href="/manifest.json"/>
<link rel="icon" href="/icons/icon-192.png"/>
<link rel="stylesheet" href="/styles.css"/>

<!-- PayPal SDK (auto inject if client id present) -->
<script>
(function(){
  const id=(window.OPENLEARN_CFG?.paypalClientId||"").trim();
  if(!id) return; const s=document.createElement("script");
  s.src=`https://www.paypal.com/sdk/js?client-id=${encodeURIComponent(id)}&currency=USD`;
  s.async=true; document.head.appendChild(s);
})();
</script>
</head>
<body>

<header id="topbar" class="bar">
  <button id="btn-burger" class="btn icon" aria-label="Menu">☰</button>
  <div id="logo">🎓 OpenLearn</div>
  <input id="topSearch" placeholder="Search courses…"/>
  <div class="grow"></div>
  <button id="btn-login" class="btn">Login</button>
  <button id="btn-logout" class="btn" style="display:none">Logout</button>
  <button id="btn-ann" class="btn icon" title="Announcements" aria-label="Announcements">📣</button>
  <button id="btn-final" class="btn icon" title="Final Exam" aria-label="Final">🎯</button>
</header>

<aside id="sidebar" class="compact">
  <nav>
    <button class="navbtn" data-page="dashboard" title="Dashboard"><i>🏠</i><span>Dashboard</span></button>
    <button class="navbtn" data-page="catalog" title="Courses"><i>📚</i><span>Courses</span></button>
    <button class="navbtn" data-page="mylearning" title="My Learning"><i>🎒</i><span>My Learning</span></button>
    <button class="navbtn" data-page="gradebook" title="Gradebook"><i>🗂️</i><span>Gradebook</span></button>
    <button class="navbtn" data-page="profile" title="Profile"><i>👤</i><span>Profile</span></button>
    <button class="navbtn" data-page="admin" title="Admin"><i>🛠️</i><span>Admin</span></button>
    <button class="navbtn" data-page="livechat" title="Live Chat"><i>💬</i><span>Live Chat</span></button>
    <button class="navbtn" data-page="settings" title="Settings"><i>⚙️</i><span>Settings</span></button>
  </nav>
</aside>

<main id="main">
  <!-- Auth full-screen (signed-out view) -->
  <section id="page-auth" class="page">
    <dialog id="authModal" class="card ol-modal open">
      <div class="logo-lg">🎓 OpenLearn</div>
      <form id="authLogin" class="stack" method="dialog">
        <label>Email <input id="loginEmail" type="email" required></label>
        <label>Password <input id="loginPass" type="password" required></label>
        <button id="doLogin" class="btn primary" type="submit">Login</button>
        <div class="row between">
          <a href="#" id="linkSignup">Sign up</a>
          <a href="#" id="linkForgot">Forgot?</a>
        </div>
      </form>
      <form id="authSignup" class="stack ol-hidden" method="dialog">
        <label>Email <input id="signupEmail" type="email" required></label>
        <label>Password <input id="signupPass" type="password" required></label>
        <button id="doSignup" class="btn primary" type="submit">Create account</button>
        <div class="row"><a href="#" id="backToLogin1">Back to login</a></div>
      </form>
      <form id="authForgot" class="stack ol-hidden" method="dialog">
        <label>Email <input id="forgotEmail" type="email" required></label>
        <button id="doForgot" class="btn">Send reset link</button>
        <div class="row"><a href="#" id="backToLogin2">Back to login</a></div>
      </form>
    </dialog>
  </section>

  <!-- Catalog -->
  <section id="page-catalog" class="page active">
    <div class="row">
      <div class="row" style="gap:8px">
        <select id="filterCategory"><option value="">All Categories</option></select>
        <select id="filterLevel">
          <option value="">All Levels</option><option>Beginner</option><option>Intermediate</option><option>Advanced</option>
        </select>
        <select id="sortBy">
          <option value="">Sort</option>
          <option value="title-asc">Title ↑</option>
          <option value="title-desc">Title ↓</option>
          <option value="price-asc">Price ↑</option>
          <option value="price-desc">Price ↓</option>
        </select>
      </div>
      <div class="grow"></div>
      <button class="btn" id="btn-add-samples">Add sample data</button>
      <button class="btn" id="btn-new-course">New Course</button>
    </div>
    <div id="catalog-grid" class="grid"></div>
  </section>

  <!-- My Learning (reader viewport built in-place) -->
  <section id="page-mylearning" class="page">
    <div id="mylearn-grid" class="grid"></div>
    <div id="reader" class="rd card hidden">
      <div class="row between">
        <div class="row" style="gap:6px">
          <button class="btn" id="rdBack">← Back</button>
          <div id="rdTitle" class="h4"></div>
        </div>
        <div class="row" style="gap:6px">
          <button class="btn" id="rdBookmark">🔖 Bookmark</button>
          <button class="btn" id="rdNote">📝 Note</button>
        </div>
      </div>
      <div class="prog"><div id="rdProgress"></div></div>
      <div id="rdPage" class="rd-body"></div>
      <div class="row between">
        <span id="rdPageInfo" class="muted"></span>
        <div class="row" style="gap:6px">
          <button class="btn" id="rdPrev">Prev</button>
          <button class="btn primary" id="rdNext">Next</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Gradebook -->
  <section id="page-gradebook" class="page">
    <h2>Gradebook</h2>
    <table class="ol-table" id="gbTable">
      <thead><tr><th>Student</th><th>Course</th><th>Score</th><th>Credits</th><th>Progress</th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="row" style="margin-top:8px">
      <button id="btn-cert" class="btn">Generate Certificate (PDF)</button>
      <button id="btn-trans" class="btn">Transcript (PDF)</button>
    </div>
  </section>

  <!-- Dashboard (Announcements + Calendar quick) -->
  <section id="page-dashboard" class="page">
    <div class="row between">
      <h2>Dashboard</h2>
      <button id="btn-new-ann" class="btn primary">+ Add Announcement</button>
    </div>
    <div id="annList" class="stack"></div>
    <div class="card">
      <div class="row between">
        <h3 class="h4">Student Calendar</h3>
        <div class="row"><input id="calTitle" placeholder="Event title"/><input id="calDate" type="date"/><button class="btn" id="addCal">Add</button></div>
      </div>
      <div id="calList" class="stack" style="margin-top:8px"></div>
    </div>
  </section>

  <!-- Admin -->
  <section id="page-admin" class="page">
    <div class="row between">
      <h2>Admin · Courses</h2>
    </div>
    <div class="card">
      <table class="ol-table" id="adminCourseTable">
        <thead><tr><th>ID</th><th>Title</th><th>Category</th><th>Level</th><th>Price</th><th>Rating</th><th>Hours</th><th></th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- Profile -->
  <section id="page-profile" class="page">
    <div class="row between"><h2>Profile</h2>
      <div class="row"><button class="btn" id="btn-edit-profile">Edit</button><button class="btn" id="btn-view-card">View Card</button></div>
    </div>
    <div id="profilePanel" class="card"></div>
  </section>

  <!-- Settings -->
  <section id="page-settings" class="page">
    <h2>Settings</h2>
    <div id="settingsPanel" class="card narrow">
      <div class="row">
        <label>Theme&nbsp;
          <select id="themeSel">
            <option value="dark">Dark</option><option value="rose">Rose</option><option value="amber">Amber</option>
            <option value="slate">Slate</option><option value="emerald">Emerald</option><option value="purple">Purple</option>
            <option value="orange">Orange</option><option value="teal">Teal</option><option value="indigo">Indigo</option><option value="ocean" selected>Ocean</option>
          </select>
        </label>
        <div class="grow"></div>
        <label>Font&nbsp;
          <select id="fontSel">
            <option value="14px">Small</option><option value="16px">Base</option><option value="18px" selected>Comfortable</option><option value="20px">Large</option><option value="22px">XL</option>
          </select>
        </label>
      </div>
      <p class="muted">Changes apply instantly site-wide.</p>
    </div>
  </section>

  <!-- Link Pages -->
  <section id="page-contact" class="page"><h2>Contact</h2><div class="card page-hero contact">
    <div class="row"><input id="cName" placeholder="Your name"/><input id="cEmail" type="email" placeholder="you@example.com"/></div>
    <textarea id="cMsg" rows="5" placeholder="How can we help?"></textarea>
    <div class="row" style="justify-content:flex-end"><button id="cSend" class="btn primary">Send</button></div>
    <div id="cStatus" class="muted" style="margin-top:6px"></div>
  </div></section>

  <section id="page-guide" class="page"><h2>Guide</h2><div class="card page-hero guide"></div></section>
  <section id="page-privacy" class="page"><h2>Privacy</h2><div class="card page-hero privacy"></div></section>
  <section id="page-policy" class="page"><h2>Policy</h2><div class="card page-hero policy"></div></section>

  <footer id="footer">
    <div class="row">
      <div class="grow"><span id="copyYear">© OpenLearn</span> ·
        <a href="#" data-link="contact">Contact</a> · <a href="#" data-link="guide">Guide</a> ·
        <a href="#" data-link="privacy">Privacy</a> · <a href="#" data-link="policy">Policy</a>
      </div>
      <div class="row" style="gap:10px">
        <!-- social svg icons -->
        <a href="#" title="YouTube" aria-label="YouTube"><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.7 3.5 12 3.5 12 3.5s-7.7 0-9.4.6A3 3 0 0 0 .5 6.2 31 31 0 0 0 0 12a31 31 0 0 0 .5 5.8 3 3 0 0 0 2.1 2.1c1.7.6 9.4.6 9.4.6s7.7 0 9.4-.6a3 3 0 0 0 2.1-2.1A31 31 0 0 0 24 12a31 31 0 0 0-.5-5.8ZM9.5 15.5v-7l6 3.5-6 3.5Z"/></svg></a>
        <a href="#" title="TikTok" aria-label="TikTok"><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M21 8.3a7 7 0 0 1-4.9-2V16a6 6 0 1 1-6-6c.3 0 .7 0 1 .1V13a3 3 0 1 0 3 3V2h2a5 5 0 0 0 4 3.9V8.3Z"/></svg></a>
        <a href="#" title="Facebook" aria-label="Facebook"><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M13 22v-9h3l1-4h-4V6a2 2 0 0 1 2-2h2V1h-3a5 5 0 0 0-5 5v3H6v4h3v9h4Z"/></svg></a>
        <a href="#" title="Instagram" aria-label="Instagram"><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm8-1a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V6Zm-4 5a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm2-5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg></a>
        <a href="#" title="Twitter/X" aria-label="Twitter"><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M18 2h3l-7 8 8 12h-6l-5-7-5 7H0l8-10L1 2h6l4 6 7-6Z"/></svg></a>
      </div>
    </div>
  </footer>
</main>

<!-- app modules -->
<script type="module" src="/firebase.js"></script>
<script type="module" src="/app.js"></script>
</body>
</html>