<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1, viewport-fit=cover, maximum-scale=1"
    />
    <title>OpenLearn · Modern Lite 2025</title>

    <link rel="icon" href="./icons/icon-192.png" />
    <link rel="manifest" href="./manifest.json" />
    <link rel="stylesheet" href="./styles.css" />

    <!-- Config + Firebase -->
    <script src="./config.js"></script>
    <script type="module" src="./firebase.js"></script>

    <!-- Optional PayPal autoload -->
    <script>
      (function injectPayPal() {
        const id = (window.OPENLEARN_CFG?.paypalClientId || "").trim();
        if (!id) return;
        const s = document.createElement("script");
        s.src =
          "https://www.paypal.com/sdk/js?client-id=" +
          encodeURIComponent(id) +
          "&currency=USD&components=buttons";
        s.async = true;
        document.head.appendChild(s);
      })();
    </script>
  </head>
  <body class="with-topbar">
    <!-- TOPBAR -->
    <header id="topbar">
      <div class="topbar-row">
        <button id="btn-burger" aria-label="Menu">☰</button>
        <div id="logo" class="logo">OpenLearn</div>

        <div id="topSearchWrap" class="search-wrap">
          <button id="topSearchToggle" aria-label="Search" class="search-ico">
            🔍
          </button>
          <input
            id="topSearch"
            class="input"
            type="search"
            placeholder="Search courses…"
          />
          <ul id="topSearchResults" class="dropdown"></ul>
        </div>
        <div id="searchResults" class="search-results" hidden></div>

        <div class="top-right">
          <button id="btn-top-ann" class="icon-pill pill-ann">
            🔔 <span class="txt">Announcements</span>
            <span id="annBadge" class="badge" style="display: none">0</span>
          </button>
          <!-- ❌ Removed Finals pill -->
          <button id="btn-login" class="btn">Login</button>
          <button id="btn-logout" class="btn" style="display: none">
            Logout
          </button>
        </div>
      </div>
    </header>

    <!-- SIDEBAR -->
    <aside id="sidebar">
      <nav>
        <button
          class="navbtn"
          data-page="catalog"
          title="Courses"
          data-requires-auth
        >
          <i>📚</i><span>Courses</span>
        </button>
        <button
          class="navbtn"
          data-page="mylearning"
          title="My Learning"
          data-requires-auth
        >
          <i>🎒</i><span>My Learning</span>
        </button>
        <button
          class="navbtn"
          data-page="dashboard"
          title="Dashboard"
          data-requires-auth
        >
          <i>🏠</i><span>Dashboard</span>
        </button>
        <button
          class="navbtn"
          data-page="gradebook"
          title="Gradebook"
          data-requires-auth
        >
          <i>🗂️</i><span>Gradebook</span>
        </button>
        <!-- ❌ Removed Final Exam item -->
        <button
          class="navbtn"
          data-page="admin"
          title="Admin"
          data-role-min="instructor"
          data-requires-auth
        >
          <i>🛠️</i><span>Admin</span>
        </button>
        <button
          class="navbtn"
          data-page="profile"
          title="Profile"
          data-requires-auth
        >
          <i>👤</i><span>Profile</span>
        </button>
        <button
          class="navbtn"
          data-page="settings"
          title="Settings"
          data-requires-auth
        >
          <i>⚙️</i><span>Settings</span>
        </button>
        <button
          class="navbtn"
          data-page="livechat"
          title="Live Chat"
          data-requires-auth
        >
          <i>💬</i><span>Live Chat</span>
        </button>
      </nav>
    </aside>

    <!-- MAIN -->
    <main id="main" class="with-topbar">
      <!-- Catalog -->
      <section id="page-catalog" class="page visible">
        <div class="row filters-wrap" style="margin-bottom: 10px">
          <select
            id="filterCategory"
            class="input"
            style="max-width: 220px"
          ></select>
          <select id="filterLevel" class="input" style="max-width: 180px">
            <option value="">All Levels</option>
            <option>Beginner</option>
            <option>Intermediate</option>
            <option>Advanced</option>
          </select>
          <select id="sortBy" class="input" style="max-width: 180px">
            <option value="">Sort</option>
            <option value="title-asc">Title A–Z</option>
            <option value="title-desc">Title Z–A</option>
            <option value="price-asc">Price Low</option>
            <option value="price-desc">Price High</option>
          </select>
          <div class="grow"></div>
          <button class="btn" id="btn-add-samples" data-requires-auth>
            Add sample data
          </button>
          <button
            class="btn primary"
            id="btn-new-course"
            data-role-min="instructor"
            data-requires-auth
          >
            + New Course
          </button>
        </div>
        <div id="courseGrid" class="grid"></div>
      </section>

      <!-- My Learning + Reader -->
      <section id="page-mylearning" class="page">
        <div id="myCourses" class="grid"></div>

        <div id="reader" class="card hidden" style="margin-top: 12px">
          <div id="rdBar" class="row">
            <button class="btn" id="rdBack">← Back</button>
            <div class="grow"></div>
            <button class="btn small" id="rdPrev">Prev</button>
            <span class="small muted" id="rdPageInfo"></span>
            <button class="btn small" id="rdNext">Next</button>
            <button class="btn small" id="rdBookmark">🔖</button>
            <button class="btn small" id="rdNote">📝</button>
          </div>
          <div class="progress"><div id="rdProgress" class="bar"></div></div>
          <h3 id="rdTitle" class="h4" style="margin-top: 10px"></h3>
          <div
            id="rdMeta"
            class="small muted"
            style="margin: 0.3rem 0 0.6rem"
          ></div>
          <div id="rdPage"></div>

          <!-- Per-course chat -->
          <section id="courseChat" class="card" style="margin-top: 12px">
            <div class="row" style="justify-content: space-between">
              <strong>Course Chat</strong>
              <label class="small muted" id="chatRoomLabel">room: —</label>
            </div>
            <div
              id="ccList"
              style="
                max-height: 260px;
                overflow: auto;
                margin: 8px 0;
                padding-right: 4px;
              "
              aria-live="polite"
            ></div>
            <div class="row" style="gap: 8px">
              <input
                id="ccInput"
                class="input grow"
                placeholder="Write a message…"
              />
              <button id="ccSend" class="btn primary" type="button">
                Send
              </button>
            </div>
          </section>
        </div>
      </section>

      <!-- Dashboard · Announcements -->
      <section id="page-dashboard" class="page">
        <div class="row" style="margin-bottom: 10px">
          <h2 class="h4">Announcements</h2>
          <div class="grow"></div>
          <button
            class="btn primary"
            id="btn-new-post"
            data-role-min="instructor"
          >
            + Add Announcement
          </button>
        </div>
        <div id="annList" class="stack"></div>
      </section>

      <!-- Gradebook -->
      <section id="page-gradebook" class="page">
        <div class="card table-responsive">
          <h3 class="h4">Gradebook</h3>
          <table class="ol-table" id="gbTable">
            <thead>
              <tr>
                <th>Student</th>
                <th>Course</th>
                <th>Score</th>
                <th>Credits</th>
                <th>Progress</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Admin -->
      <section id="page-admin" class="page">
        <!-- Admin: Course Creation Guide button -->
        <button class="btn" id="btn-course-guide">Course Creation Guide</button>
        <div class="card">
          <h3 class="h4">Courses</h3>
          <table class="ol-table" id="adminTable">
            <thead>
              <tr>
                <th>Title</th>
                <th>Category</th>
                <th>Level</th>
                <th>Rating</th>
                <th>Hours</th>
                <th>Price</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="row" style="gap: 8px; justify-content: flex-end">
          <button class="btn" id="btn-export" data-requires-auth>
            Export My Courses
          </button>
          <button class="btn" id="btn-import" data-requires-auth>Import</button>
          <input
            id="importFile"
            type="file"
            accept="application/json"
            class="hidden"
          />
        </div>
      </section>

      <!-- Profile -->
      <section id="page-profile" class="page">
        <div class="row" style="margin-bottom: 10px">
          <h2 class="h4">Profile</h2>
          <div class="grow"></div>
          <button class="btn" id="btn-edit-profile">+ Add Profile Data</button>
        </div>
        <div id="profilePanel" class="card"></div>
      </section>

      <!-- Settings -->
      <section id="page-settings" class="page">
        <div class="card narrow">
          <div class="row">
            <label
              >Theme&nbsp;
              <select id="themeSel" class="input" style="max-width: 200px">
                <option value="dark">Dark</option>
                <option value="rose">Rose</option>
                <option value="ocean">Ocean</option>
                <option value="amber">Amber</option>
                <option value="slate" selected>Slate</option>
                <option value="light">Light</option>
                <option value="gray">Gray</option>
                <option value="offwhite">Offwhite</option>
                <option value="forest">Forest</option>
                <option value="sunset">Sunset</option>
                <option value="lavender">Lavender</option>
                <option value="emerald">Emerald</option>
              </select>
            </label>
            <div class="grow"></div>
            <label
              >Font size&nbsp;
              <select id="fontSel" class="input" style="max-width: 160px">
                <option value="14">Small</option>
                <option value="16" selected>Base</option>
                <option value="18">Comfortable</option>
                <option value="20">Large</option>
                <option value="22">XL</option>
              </select>
            </label>
          </div>
        </div>
        <div class="card" id="settings-help">
          <div class="row" style="align-items: center">
            <h3 class="h4">Help & Guide</h3>
            <div class="grow"></div>
            <!-- ဒီ link ကို project ထဲမှာ /docs/settingUpDetails.md ထည့်ပြီး ပြောင်းသုံးနိုင် -->
            <!-- <a class="btn small" id="devGuideLink" href="#" download
              >Developer Guide (MD)</a
            > -->
          </div>
          <div id="helpDoc" class="help-body"></div>
        </div>
      </section>

      <!-- Live Chat -->
      <section id="page-livechat" class="page">
        <div class="card narrow">
          <div class="row"><h3 class="h4">Live Chat</h3></div>
          <div
            id="chatBox"
            aria-live="polite"
            style="max-height: 260px; overflow: auto"
          ></div>
          <div class="row" style="margin-top: 8px">
            <input
              id="chatInput"
              class="input grow"
              placeholder="Type a message…"
            />
            <button class="btn" id="chatSend" type="button">Send</button>
          </div>
        </div>
      </section>
    </main>

    <!-- MODALS -->
    <dialog id="authModal" class="ol-modal card auth-modern">
      <div class="auth-brand">🎓 OpenLearn</div>
      <form id="authLogin" class="authpane" method="dialog">
        <label
          >Email
          <input
            id="loginEmail"
            class="input"
            type="email"
            placeholder="you@example.com"
            required
          />
        </label>
        <label
          >Password
          <div class="pw-wrap">
            <input
              id="loginPass"
              class="input"
              type="password"
              placeholder="••••••••"
              required
            />
            <button
              type="button"
              class="pw-toggle"
              id="loginPwToggle"
              aria-label="Show password"
            >
              👁
            </button>
          </div>
        </label>

        <button class="btn primary wide" id="doLogin" type="submit">
          Login
        </button>

        <div class="auth-links">
          <a href="#" id="linkSignup">Create an account</a>
          <a href="#" id="linkForgot">Forgot password?</a>
        </div>
      </form>

      <form id="authSignup" class="authpane ol-hidden" method="dialog">
        <label
          >Email
          <input
            id="signupEmail"
            class="input"
            type="email"
            placeholder="you@example.com"
            required
          />
        </label>
        <label
          >Password
          <div class="pw-wrap">
            <input
              id="signupPass"
              class="input"
              type="password"
              placeholder="At least 6 characters"
              required
            />
            <button
              type="button"
              class="pw-toggle"
              id="signupPwToggle"
              aria-label="Show password"
            >
              👁
            </button>
          </div>
        </label>

        <button class="btn primary wide" id="doSignup" type="submit">
          Create Account
        </button>

        <div class="auth-links single">
          <a href="#" id="backToLogin1">Back to login</a>
        </div>
      </form>

      <form id="authForgot" class="authpane ol-hidden" method="dialog">
        <label
          >Email
          <input
            id="forgotEmail"
            class="input"
            type="email"
            placeholder="you@example.com"
            required
          />
        </label>

        <button class="btn wide" id="doForgot" type="submit">
          Send Reset Link
        </button>

        <div class="auth-links single">
          <a href="#" id="backToLogin2">Back to login</a>
        </div>
      </form>
    </dialog>

    <dialog id="detailsModal" class="ol-modal card">
      <div
        class="row"
        style="
          justify-content: space-between;
          align-items: center;
          margin-bottom: 6px;
        "
      >
        <b class="modal-title">Course Details</b>
        <button class="btn small" id="closeDetails" type="button">Close</button>
      </div>
      <div id="detailsBody"></div>
    </dialog>

    <dialog id="payModal" class="ol-modal card">
      <div
        class="row"
        style="
          justify-content: space-between;
          align-items: center;
          margin-bottom: 6px;
        "
      >
        <b class="modal-title" id="payTitle">Checkout</b>
        <button class="btn small" id="closePay" type="button">Close</button>
      </div>
      <div id="payBody" class="row" style="flex-wrap: wrap; gap: 12px">
        <div class="card" style="flex: 1; min-width: 260px">
          <h3 class="h4">Pay with PayPal (USD)</h3>
          <div id="paypal-container"></div>
          <div class="muted" id="paypalNote"></div>
        </div>
        <div class="card" style="flex: 1; min-width: 260px">
          <h3 class="h4">Pay with MMK</h3>
          <p class="muted">Demo QR → press “I Paid”.</p>
          <div class="row" style="gap: 10px; flex-wrap: wrap">
            <img
              class="qr"
              alt="CBPay"
              src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=CBPAY-DEMO"
            />
            <img
              class="qr"
              alt="KBZPay"
              src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=KBZPAY-DEMO"
            />
            <img
              class="qr"
              alt="WavePay"
              src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=WAVEPAY-DEMO"
            />
          </div>
          <button class="btn primary" id="mmkPaid">I Paid (MMK)</button>
        </div>
      </div>
    </dialog>

    <dialog id="courseModal" class="ol-modal card">
      <form
        id="courseForm"
        method="dialog"
        class="authpane"
        style="grid-template-columns: repeat(12, 1fr)"
      >
        <!-- 1) Top: Title + Close -->
        <div
          class="row"
          style="
            grid-column: 1/-1;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
          "
        >
          <b class="modal-title">New Course</b>
          <div class="row" style="gap: 6px">
            <button class="btn small" id="btn-course-close" type="button">
              Close
            </button>
          </div>
        </div>

        <!-- 2) Course ID & Category -->
        <label style="grid-column: 1/7"
          >Course ID
          <input
            id="courseId"
            class="input"
            placeholder="e.g., web-essentials"
            required
          />
        </label>
        <label style="grid-column: 7/13"
          >Category
          <input
            id="courseCat"
            class="input"
            placeholder="e.g., Web"
            required
          />
        </label>

        <!-- 3) Title & Level -->
        <label style="grid-column: 1/9"
          >Title
          <input
            id="courseTitle"
            class="input"
            placeholder="Course title"
            required
          />
        </label>
        <label style="grid-column: 9/13"
          >Level
          <select id="courseLevel" class="input">
            <option>Beginner</option>
            <option>Intermediate</option>
            <option>Advanced</option>
          </select>
        </label>

        <!-- 4) Summary -->
        <label style="grid-column: 1/-1"
          >Summary
          <textarea
            id="courseSummary"
            class="input"
            rows="3"
            placeholder="Short description"
          ></textarea>
        </label>

        <!-- 5) Benefits -->
        <label style="grid-column: 1/-1"
          >Benefits
          <textarea
            id="courseBenefits"
            class="input"
            rows="3"
            placeholder="Hands-on projects&#10;Downloadable resources&#10;Certificate"
          ></textarea>
        </label>

        <!-- 6) Cover Image, Hours, Credits, Price -->
        <label style="grid-column: 1/7"
          >Cover Image URL (optional)
          <input
            id="courseImage"
            class="input"
            placeholder="https://… or /assets/…"
          />
        </label>
        <label style="grid-column: 7/10"
          >Hours
          <input
            id="courseHours"
            type="number"
            min="1"
            value="8"
            class="input"
          />
        </label>
        <label style="grid-column: 10/12"
          >Credits
          <input
            id="courseCredits"
            type="number"
            min="1"
            value="2"
            class="input"
          />
        </label>
        <label style="grid-column: 12/13"
          >Price ($)
          <input
            id="coursePrice"
            type="number"
            min="0"
            value="0"
            class="input"
          />
        </label>

        <!-- 7) Initial Lessons -->
        <fieldset class="card" style="grid-column: 1/-1">
          <legend>Initial Lessons</legend>
          <div class="row" style="gap: 12px; align-items: flex-start">
            <label
              >Count
              <input
                id="courseLessons"
                type="number"
                min="1"
                value="3"
                class="input"
                style="max-width: 120px"
              />
            </label>
            <label class="grow"
              >Optional lesson plan (one per line)
              <textarea
                id="lessonPlan"
                class="input"
                rows="6"
                placeholder="lesson-0: intro&#10;lesson-1: elements and tags, quiz&#10;lesson-2: page layouts, quiz"
              ></textarea>
            </label>
          </div>
          <small class="muted"
            >If you provide a plan, it overrides the count. Add
            <code>, quiz</code> to create a quiz skeleton for that
            lesson.</small
          >
        </fieldset>

        <!-- 8) Save & Cancel -->
        <div
          class="row"
          style="grid-column: 1/-1; justify-content: flex-end; gap: 8px"
        >
          <button class="btn" id="btn-course-cancel" type="button">
            Cancel
          </button>
          <button class="btn primary" id="btn-course-save" type="submit">
            Save
          </button>
        </div>
      </form>
    </dialog>

    <dialog id="guideModal" class="ol-modal card" style="max-width: 880px">
      <form method="dialog" class="stack">
        <div
          class="row"
          style="justify-content: space-between; align-items: center"
        >
          <b>Course Creation Guide</b>
          <button type="button" class="btn small" id="btn-guide-close">
            Close
          </button>
        </div>

        <article class="prose" style="max-height: 70vh; overflow: auto">
          <h3>Overview</h3>
          <p>
            ဤလမ်းညွှန်သည် <code>/public/data</code> အောက်တွင်
            <code>courses/&lt;id&gt;</code> ဖိုလ်ဒါအောက် <code>meta.json</code>၊
            <code>lessons/*.html</code>၊ <code>quizzes/*.json</code> တို့ကို
            စနစ်တကျ တည်ဆောက်ရန်အတွက် ဖြစ်ပါတယ်။
          </p>

          <h3>1) Catalog (Cards) — <code>/public/data/catalog.json</code></h3>
          <p>
            Catalog တွင် Cards အတွက် အသုံးပြုမည့် အကျဉ်းချုံ့တန်ဖိုးများကို
            ထည့်ပါ။ <strong>id</strong> သည် course folder နာမည်နှင့်
            <strong>တူရ</strong>ပါမည်။
          </p>
          <pre><code>{
  "id": "pali-basics",
  "title": "ပါဠိ အခြေခံ",
  "category": "Language",
  "level": "Beginner",
  "price": 0,
  "credits": 2,
  "rating": 4.7,
  "hours": 20,
  "summary": "…",
  "image": "/data/courses/pali-basics/images/cover.jpg",
  "benefits": "အခြေခံမှစ…\nအသံထွက်…\nလေ့ကျင့်ခန်း…"
}</code></pre>

          <h3>
            2) Folder Structure — <code>/public/data/courses/&lt;id&gt;/</code>
          </h3>
          <pre><code>public/
  data/
    courses/
      pali-basics/
        meta.json
        lessons/
          lesson-00.html
          lesson-01.html
        quizzes/
          lesson-01.json
        images/
          cover.jpg</code></pre>

          <h3>3) Meta (Reader Source) — <code>meta.json</code></h3>
          <p>
            <code>meta.json</code> သည် reader UI အတွက် အဓိကအချက်အလက်ဖြစ်ပြီး
            modules/lessons/quiz များကို ညွှန်းပေးပါသည်။
          </p>
          <pre><code>{
  "id": "pali-basics",
  "title": "ပါဠိ အခြေခံ",
  "category": "Language",
  "level": "Beginner",
  "image": "/data/courses/pali-basics/images/cover.jpg",
  "summary": "…",
  "description": "…",
  "benefits": [
    "စာလုံးပေါင်း အခြေခံ",
    "ဝေါဟာရ လေ့ကျင့်",
    "သဒ္ဒါ စနစ်တကျ"
  ],
  "credits": 2,
  "hours": 20,
  "modules": [
    {
      "title": "သာသနာအစ",
      "lessons": [
        { "type": "html", "title": "ဘုရားဖြစ်ပေါ်လာပုံ", "src": "lessons/lesson-00.html" },
        { "type": "html", "title": "တပည့်များပေါ်ထွန်းလာပုံ", "src": "lessons/lesson-01.html" },
        { "type": "quiz", "src": "quizzes/lesson-01.json" }
      ]
    }
  ]
}</code></pre>

          <h3>4) Lessons HTML — <code>lessons/*.html</code></h3>
          <pre><code>&lt;!-- ဘုရားဖြစ်ပေါ်လာပုံ --&gt;
&lt;h2&gt;သာသနာအစ · ဘုရားဖြစ်ပေါ်လာပုံ&lt;/h2&gt;
&lt;p&gt;Write your content here…&lt;/p&gt;</code></pre>

          <h3>5) Quizzes JSON — <code>quizzes/*.json</code></h3>
          <p>အခြေခံနမူနာ (legacy/short form) — app က normalize လုပ်ပေးသည်။</p>
          <pre><code>[
  { "type":"single", "q":"Pali vowel a?", "a":["a","i","u"], "correct":0 },
  { "type":"short",  "q":"“Buddha” in Pali", "a":"Buddho" }
]</code></pre>

          <h3>6) Scaffold JSON (Optional, Admin Only)</h3>
          <p>
            New Course form မှာ <em>*-scaffold.json</em> ထုတ်ပေးပါသည်။ ဤဖိုင်သည်
            <strong>path → content</strong> mapping ဖြစ်ပြီး Runtime မဖတ်ပါ။
            Unpack ပြုလုပ်ပြီး <code>/public/data/...</code> ထဲ
            <strong>တကယ့်ဖိုင်များ</strong> ထည့်ရန်သာ အသုံးပြုပါ။
          </p>
          <ul>
            <li>
              <strong>Option A (ZIP):</strong> unpack tool ဖြင့် ZIP ထုတ် ➜
              unzip ➜ <code>public/data/...</code> ထဲ copy
            </li>
            <li>
              <strong>Option B (Direct Write):</strong> browser File System API
              ဖြင့် <code>public/data</code> ကိုရွေးပြီး တိုက်ရိုက်ရေး
            </li>
          </ul>

          <h3>7) IDs ထည့်သင့်ညီညွတ်မှု</h3>
          <ul>
            <li>
              Catalog item <code>id</code> = folder name &lt;id&gt; = meta.json
              <code>id</code>
            </li>
            <li>
              Meta lessons src များသည် folder အတွင်း relative path (ဥပမာ
              <code>lessons/lesson-00.html</code>)
            </li>
          </ul>

          <h3>8) Cards/Details တွင်ပြမည့် field များ</h3>
          <ul>
            <li>
              <strong>Cards</strong>: <code>catalog.json</code> → title,
              category, level, rating, hours, summary, image,
              <em>benefits (newline)</em>
            </li>
            <li>
              <strong>Details</strong>: <code>meta.json</code> → description,
              <em>benefits (array/string)</em>, modules/lessons
            </li>
          </ul>

          <h3>9) Checklist</h3>
          <ul>
            <li>catalog.json ထဲ <code>id</code> ထည့်ပြီး ဖြည့်စွက်</li>
            <li>
              <code>/public/data/courses/&lt;id&gt;/</code> ထဲ meta.json,
              lessons/, quizzes/, images/ စနစ်တကျ
            </li>
            <li>
              meta.modules[].lessons[] ထဲ HTML/Quiz
              <code>src</code> လမ်းကြောင်းတိတိ
            </li>
            <li>Image path တို့ <code>/data/…</code> ဖြင့် ကိုက်ညီ</li>
          </ul>

          <h3>10) Troubleshooting</h3>
          <ul>
            <li>
              Reader မဖတ်လျှင်: Network tab မှာ <code>meta.json</code> /
              <code>lessons/*.html</code> / <code>quizzes/*.json</code> fetch
              200/404 စစ်
            </li>
            <li>
              Benefits မပေါ်လျှင်: catalog.json (cards), meta.json (details)
              နှစ်ဖိုင်စစ်
            </li>
            <li>
              Cover ပြတ်လျှင်:
              <code
                >.course-cover { object-fit: contain; aspect-ratio:16/9; }</code
              >
            </li>
          </ul>
        </article>

        <div class="row" style="justify-content: flex-end">
          <button type="button" class="btn" id="btn-guide-close-2">
            Close
          </button>
        </div>
      </form>
    </dialog>

    <!-- <dialog id="postModal" class="ol-modal card">
      <div
        class="row"
        style="
          justify-content: space-between;
          align-items: center;
          margin-bottom: 6px;
        "
      >
        <b class="modal-title">New Announcement</b>
        <button class="btn small" id="closePostModal" type="button">
          Close
        </button>
      </div>
      <form id="postForm" class="authpane">
        <label>Title <input id="pmTitle" class="input" required /></label>
        <label style="grid-column: 1/-1"
          >Body
          <textarea id="pmBody" class="input" rows="6" required></textarea>
        </label>
        <div class="row" style="justify-content: flex-end; gap: 8px">
          <button class="btn" id="cancelPost" type="button">Cancel</button>
          <button class="btn primary" id="savePost" type="submit">Post</button>
        </div>
      </form>
    </dialog> -->

    <dialog id="profileEditModal" class="ol-modal card">
      <div
        class="row"
        style="
          justify-content: space-between;
          align-items: center;
          margin-bottom: 6px;
        "
      >
        <b class="modal-title">Add Profile Data</b>
        <button class="btn small" id="closeProfileModal" type="button">
          Close
        </button>
      </div>
      <form id="profileForm" class="authpane">
        <label>Name <input name="displayName" class="input" /></label>
        <label
          >Avatar URL
          <input name="photoURL" class="input" placeholder="https://..."
        /></label>
        <small class="muted"
          >You can either paste a URL from your google drive</small
        >
        <!-- <label>Upload Avatar (optional)</label>
        <input id="avatarFile" type="file" accept="image/*" class="input" />
        <button type="button" class="btn" id="avatarUploadBtn">
          Upload to Cloud
        </button>
        <small class="muted"
          >You can either paste a URL above OR upload from your computer.</small
        > -->
        <label style="grid-column: 1/-1"
          >Short Bio <textarea name="bio" class="input" rows="3"></textarea>
        </label>
        <label style="grid-column: 1/-1"
          >Skills (comma-separated)
          <input name="skills" class="input" placeholder="JS, React, UI/UX" />
        </label>
        <label style="grid-column: 1/-1"
          >Portfolio Links
          <input name="links" class="input" placeholder="https://..." />
        </label>
        <label style="grid-column: 1/-1"
          >Social Links
          <input name="social" class="input" placeholder="https://..." />
        </label>
        <div
          class="row"
          style="grid-column: 1/-1; justify-content: flex-end; gap: 8px"
        >
          <button class="btn" id="cancelProfile" type="button">Cancel</button>
          <button class="btn primary" type="submit">Save</button>
        </div>
      </form>
    </dialog>

    <dialog id="adminViewModal" class="ol-modal">
      <div class="card">
        <div
          class="row"
          style="justify-content: space-between; align-items: center"
        >
          <strong id="avmTitle">Course</strong>
          <button class="btn" id="avmClose">Close</button>
        </div>
        <div id="avmBody" class="muted" style="margin: 0.5rem 0 1rem"></div>
        <div class="row" style="gap: 8px; justify-content: flex-end">
          <button
            class="btn small"
            id="avmEdit"
            data-edit="..."
            data-role-min="instructor"
          >
            Edit
          </button>
          <button
            class="btn small"
            id="avmDelete"
            data-del="..."
            data-role-min="instructor"
          >
            Delete
          </button>
        </div>
      </div>
    </dialog>
    <!-- Announcements Modal -->
    <dialog id="annModal" class="ol-modal card" style="max-width: 680px">
      <form
        id="annForm"
        method="dialog"
        class="authpane"
        style="display: grid; gap: 10px"
      >
        <!-- Hidden ID for edit -->
        <input id="annId" type="hidden" />

        <div
          class="row"
          style="justify-content: space-between; align-items: center"
        >
          <b id="annModalTitle">New Announcement</b>
          <div class="row" style="gap: 6px">
            <button class="btn small" type="button" id="annClose">Close</button>
          </div>
        </div>

        <label
          >Title
          <input
            id="annTitle"
            class="input"
            required
            placeholder="Announcement title"
          />
        </label>

        <label
          >Audience
          <select id="annAudience" class="input">
            <option value="all">Everyone</option>
            <option value="students">Students only</option>
            <option value="instructors">Instructors/Staff</option>
          </select>
        </label>

        <label
          >Message
          <textarea
            id="annBody"
            class="input"
            rows="5"
            placeholder="Write your announcement…"
            required
          ></textarea>
        </label>

        <div class="row" style="justify-content: flex-end; gap: 8px">
          <button class="btn" type="button" id="annCancel">Cancel</button>
          <button class="btn primary" type="submit" id="annSave">Save</button>
        </div>
      </form>
    </dialog>
    <dialog id="certModal" class="ol-modal card">
      <div id="certBody"></div>
      <div
        class="row no-print"
        style="justify-content: flex-end; gap: 8px; margin-top: 10px"
      >
        <button class="btn" id="certPrint" type="button">
          Print / Save PDF
        </button>
        <button class="btn" id="certClose" type="button">Close</button>
      </div>
    </dialog>

    <!-- Toast -->
    <div id="toast"></div>

    <!-- App -->
    <script>
      window.OPENLEARN_DATA_BASE = "/data";
    </script>
    <!-- <script type="module" src="./app.js"></script> -->
    <script>
      window.renderProfilePanel ||= () => {};
      window.renderMyLearning ||= () => {};
      window.renderGradebook ||= () => {};
      window.renderAdminTable ||= () => {};
      window.renderAnnouncements ||= () => {};
    </script>
    <script type="module" src="./app.js?v=ff-safe-2"></script>

    <!-- tiny UX: mobile search toggle (no duplicate listeners) -->
    <script>
      (function () {
        const btn = document.getElementById("topSearchToggle");
        if (!btn) return;
        btn.addEventListener("click", () => {
          document.body.classList.toggle("search-open");
          const box = document.getElementById("topSearch");
          if (box && document.body.classList.contains("search-open"))
            box.focus();
        });
      })();
    </script>
  </body>
</html>
