<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenLearn — v1Fix Pro</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <button id="hamburger" class="btn ghost" aria-label="Toggle menu">☰</button>
    <div class="brand">📘 OpenLearn</div>

    <!-- Top search -->
    <div class="top-search">
      <input id="topSearch" type="search" placeholder="Search courses…" />
      <button id="topSearchBtn" class="btn ghost" aria-label="Search">🔍</button>
    </div>

    <div class="spacer"></div>

    <!-- Theme & font quick controls open Settings -->
    <button id="btnSettings" class="btn ghost" title="Settings">⚙️</button>

    <!-- Auth buttons -->
    <button id="btnLogin" class="btn">Login</button>
    <button id="btnSignup" class="btn">Sign up</button>
    <div id="userMenu" class="user-menu hidden">
      <span id="userName"></span>
      <button id="btnLogoutTop" class="btn ghost">Logout</button>
    </div>
    <button id="btnTopAdmin" class="btn admin-only hidden">Admin</button>
  </header>

  <div class="layout">
    <aside id="sidebar" class="sidebar" aria-label="Sidebar">
      <nav class="side-nav">
        <button class="side-item active" data-page="courses">🏠 Courses</button>
        <button class="side-item" data-page="mylearning">📂 My Learning</button>
        <button class="side-item" data-page="gradebook">🧮 Gradebook</button>
        <div class="side-section">🛡️ Admin</div>
        <button class="side-item admin-only hidden" data-page="admin">🛠️ Admin</button>
        <button class="side-item admin-only hidden" data-page="analytics">📊 Analytics</button>
        <div class="side-section">👤 Personal</div>
        <button class="side-item" data-page="settings">⚙️ Settings</button>
      </nav>
    </aside>

    <main class="content">
      <!-- Catalog / Courses -->
      <section id="page-catalog" class="page visible">
        <h2>Catalog</h2>
        <div class="controls">
          <input id="searchInput" placeholder="Search courses…" />
          <select id="filterLevel">
            <option value="">All Levels</option>
            <option>Beginner</option><option>Intermediate</option><option>Advanced</option>
          </select>
          <select id="filterCategory">
            <option value="">All Categories</option>
          </select>
          <select id="sortBy">
            <option value="title-asc">Title ↑</option>
            <option value="title-desc">Title ↓</option>
            <option value="rating-desc">Rating ↓</option>
            <option value="price-asc">Price ↑</option>
            <option value="price-desc">Price ↓</option>
          </select>
        </div>
        <div id="courseGrid" class="grid"></div>
        <div class="pager">
          <button id="pgPrev" class="btn">Prev</button>
          <span id="pgInfo" class="muted"></span>
          <button id="pgNext" class="btn">Next</button>
        </div>
      </section>

      <!-- Course detail -->
      <section id="page-course" class="page">
        <h2>Course</h2>
        <div id="courseHeader" class="course-header"></div>
        <div class="course-body">
          <aside class="syllabus">
            <h4>Syllabus</h4>
            <ol id="lessonList"></ol>
          </aside>
          <article id="lessonContent" class="lesson-content"></article>
          <aside class="course-tools">
            <div class="card">
              <h4>Progress</h4>
              <div id="progressBox" class="muted">-</div>
              <button id="btnMarkComplete" class="btn">Mark lesson complete</button>
              <button id="btnCertificate" class="btn ghost">Get Certificate</button>
            </div>
            <div class="card">
              <h4>Discussion</h4>
              <div id="comments"></div>
              <form id="formComment" class="stack">
                <textarea id="commentText" placeholder="Write a comment…" rows="2"></textarea>
                <button class="btn">Post</button>
              </form>
            </div>
          </aside>
        </div>
      </section>

      <!-- My Learning -->
      <section id="page-mylearning" class="page">
        <h2>My Learning</h2>
        <div id="myCourses" class="grid"></div>
      </section>

      <!-- Gradebook -->
      <section id="page-gradebook" class="page">
        <h2>Gradebook</h2>
        <div class="row">
          <select id="gbCourseSelect"></select>
          <button id="gbRefresh" class="btn">Refresh</button>
        </div>
        <table class="table" id="gbTable">
          <thead><tr><th>Student</th><th>Course</th><th>Progress</th><th>Last Activity</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- Admin -->
      <section id="page-admin" class="page">
        <h2>Admin</h2>
        <div class="card muted">Admin dashboard…</div>
      </section>

      <!-- Analytics -->
      <section id="page-analytics" class="page">
        <h2>Analytics</h2>
        <div class="card muted">Charts & metrics…</div>
      </section>

      <!-- Settings -->
      <section id="page-settings" class="page">
        <h2>Settings</h2>
        <div class="grid2">
          <div class="card">
            <h4>Theme</h4>
            <select id="themeSelect">
              <option value="dark">Dark (Default)</option>
              <option value="light">Light</option>
              <option value="ocean">Ocean</option>
              <option value="forest">Forest</option>
              <option value="grape">Grape</option>
            </select>
          </div>
          <div class="card">
            <h4>Font size</h4>
            <select id="fontSelect">
              <option value="13">13 px</option>
              <option value="14" selected>14 px</option>
              <option value="15">15 px</option>
              <option value="16">16 px</option>
              <option value="17">17 px</option>
              <option value="18">18 px</option>
            </select>
            <div class="muted" id="fontPreview">14 px</div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Auth Dialogs -->
  <dialog id="dlgLogin"><form id="formLogin" method="dialog" class="stack">
    <h3>Login</h3>
    <input id="loginEmail" type="email" placeholder="Email" required />
    <input id="loginPassword" type="password" placeholder="Password" required />
    <menu class="row">
      <button class="btn primary">Login</button>
      <button type="button" class="btn ghost dlg-close">Close</button>
    </menu>
    <div class="muted">Forgot? <a href="#" id="lnkForgot">Reset</a></div>
    <div class="muted">New? <a href="#" id="lnkToSignup">Sign up</a></div>
  </form></dialog>

  <dialog id="dlgSignup"><form id="formSignup" method="dialog" class="stack">
    <h3>Sign up</h3>
    <input id="suName" placeholder="Full name" />
    <input id="suEmail" type="email" placeholder="Email" required />
    <input id="suPassword" type="password" placeholder="Password (6+)" required />
    <input id="suConfirm" type="password" placeholder="Confirm" required />
    <input id="suAdminKey" placeholder="Admin Access Key (optional)" />
    <menu class="row">
      <button class="btn primary">Create account</button>
      <button type="button" class="btn ghost dlg-close">Close</button>
    </menu>
    <div class="muted">Have an account? <a href="#" id="lnkToLogin">Login</a></div>
  </form></dialog>

  <dialog id="dlgForgot"><form id="formForgot" method="dialog" class="stack">
    <h3>Reset password</h3>
    <input id="fpEmail" type="email" placeholder="Email" required />
    <menu class="row">
      <button class="btn primary">Send reset email</button>
      <button type="button" class="btn ghost dlg-close">Close</button>
    </menu>
  </form></dialog>

  <div id="toast"></div>
  <script type="module" src="firebase.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
